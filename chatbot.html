<script>
  const chat = document.getElementById('chat');
  const form = document.getElementById('chat-form');
  const input = document.getElementById('user-input');

  const customerIcon = '<img src="customer.jpg" alt="Customer" class="w-8 h-8 ml-2 rounded-full ring-2 ring-teal-500">';
  const botIcon = '<img src="bot.jpg" alt="Bot" class="w-8 h-8 mr-2 rounded-full ring-2 ring-teal-500">';

  // Show input from start
  form.classList.remove('hidden');

  function appendMessage(text, sender, isTyping = false) {
    const row = document.createElement('div');
    row.className = `flex items-end mb-3 ${sender === 'user' ? 'justify-end' : 'justify-start'}`;

    if (sender === 'bot') {
      const iconWrapper = document.createElement('div');
      iconWrapper.className = 'flex-shrink-0';
      iconWrapper.innerHTML = botIcon;
      row.appendChild(iconWrapper);
    }

    const bubble = document.createElement('div');
    bubble.className = `max-w-[80%] px-4 py-2 rounded-2xl text-base leading-snug ${
      sender === 'user' ? 'bg-teal-300 text-teal-900 rounded-br-none' : 'bg-teal-700 text-white rounded-bl-none'
    }`;
    bubble.innerHTML = isTyping ? '<span class="italic">Typing...</span>' : text;
    row.appendChild(bubble);

    if (sender === 'user') {
      const iconWrapper = document.createElement('div');
      iconWrapper.className = 'flex-shrink-0';
      iconWrapper.innerHTML = customerIcon;
      row.appendChild(iconWrapper);
    }

    chat.appendChild(row);
    chat.scrollTop = chat.scrollHeight;
  }

  // Bot responses (loop removed)
  function botReply(userText) {
    const lower = userText.toLowerCase();
    let reply = "Got it!";

    if (lower.includes("hello") || lower.includes("hi")) {
      reply = "Hello! How can I help you?";
    } else if (lower.includes("price")) {
      reply = "Could you tell me which product you're interested in?";
    } else if (lower.includes("bye")) {
      reply = "Goodbye! Have a great day.";
    }

    appendMessage(reply, 'bot');
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const userText = input.value.trim();
    if (!userText) return;

    appendMessage(userText, 'user');
    input.value = '';
    botReply(userText);
  });

  window.onload = () => {
    appendMessage("Hello! I'm Yati ðŸ˜Š How can I help you today?", 'bot');
  }
</script>
